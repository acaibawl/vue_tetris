var j=Object.defineProperty;var Y=(c,e,t)=>e in c?j(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var w=(c,e,t)=>(Y(c,typeof e!="symbol"?e+"":e,t),t);import{r as U,o as _,c as q,d as I,a as P,u as z,b as m,e as f,t as L,f as b,w as J,v as K,F as k,p as D,g as M,h as E,n as R,i as Z,j as H,k as W,l as Q,m as X,q as ee,s as te,x as oe}from"./vendor.20713e0b.js";const ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}};ne();var F=(c,e)=>{const t=c.__vccOpts||c;for(const[a,r]of e)t[a]=r;return t};const re={};function se(c,e){const t=U("router-view");return _(),q(t)}var ae=F(re,[["render",se]]);const $=c=>(D("data-v-f9f795b0"),c=c(),M(),c),ce=$(()=>f("h1",null,"\u30C8\u30C3\u30D7\u753B\u9762",-1)),le=$(()=>f("br",null,null,-1)),ie=$(()=>f("br",null,null,-1)),ue=I({setup(c){const e=P({name:""}),t=z(),a=()=>{t.push({name:"PlayPage",query:{name:e.name}})};return(r,o)=>(_(),m(k,null,[ce,f("p",null,L(b(e).name),1),J(f("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>b(e).name=n),placeholder:"\u540D\u524D\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044\uFF0810\u6587\u5B57\u4EE5\u5185\uFF09",maxlength:"10"},null,512),[[K,b(e).name]]),le,ie,f("button",{onClick:o[1]||(o[1]=n=>a())}," \u30B2\u30FC\u30E0\u30B9\u30BF\u30FC\u30C8\uFF01 ")],64))}});var de=F(ue,[["__scopeId","data-v-f9f795b0"]]);const G=[[[0]],[[1,1,1,1]],[[2,2],[2,2]],[[0,3,3],[3,3,0]],[[4,4,0],[0,4,4]],[[0,0,5],[5,5,5]],[[6,0,0],[6,6,6]],[[0,7,0],[7,7,7]]],g={I:1,O:2,S:3,Z:4,J:5,L:6,T:7};class p{constructor(e){w(this,"type");this.type=e}static id(e){switch(e){case g.I:return"block-i";case g.O:return"block-o";case g.S:return"block-s";case g.Z:return"block-z";case g.J:return"block-j";case g.L:return"block-l";case g.T:return"block-t";default:return""}}get data(){return G[this.type]}static random(){const e=G.length-1,t=Math.floor(Math.random()*e)+1;return new p(t)}static rotate(e,t){let a=t;for(let r=0;r<e;r++)a=a[0].map((o,n)=>a.map(s=>s[n]).reverse());return a}static empty(){return new p(0)}}const O=class{constructor(e){w(this,"field");w(this,"update",(e,t)=>{for(let a=0;a<e.length;a++){const r=e[a];for(let o=0;o<r.length;o++){const n=r[o];n>0&&(this.field[a+t.y][o+t.x]=n)}}});w(this,"canMove",(e,t)=>{const a=this.field.length,r=this.field[0].length;if(t.y>=a)return!1;for(let o=0;o<e.length;o++){const n=e[o];for(let s=0;s<n.length;s++)if(n[s]>0&&(o+t.y>a-1||0>s+t.x||s+t.x>r-1||this.field[o+t.y][s+t.x]>0))return!1}return!0});if(e)this.field=e;else{const t=20,a=10,r=new Array(t);for(let o=0;o<t;o++){const n=new Array(a).fill(0);r[o]=n}this.field=r}}get data(){return this.field}};let y=O;w(y,"deepCopy",e=>{const t=e.data,a=new Array(t.length);for(const[r,o]of t.entries()){a[r]=new Array(o.length);for(const[n]of o.entries())a[r][n]=t[r][n]}return new O(a)});const fe=c=>(D("data-v-5cbcabc0"),c=c(),M(),c),pe={class:"tetromino-preview"},_e=fe(()=>f("label",null,"\u6B21\u306E\u30D6\u30ED\u30C3\u30AF",-1)),me={class:"field",style:{"border-collapse":"collapse"}},ye=I({props:{tetromino:{default:void 0}},setup(c){const e=c,t=a=>a===0?"no-block":p.id(a);return(a,r)=>(_(),m("div",pe,[_e,f("table",me,[(_(!0),m(k,null,E(e.tetromino,(o,n)=>(_(),m("tr",{key:n},[(_(!0),m(k,null,E(o,(s,h)=>(_(),m("td",{key:()=>`${h}${n}`,class:R(["block",t(s)])},null,2))),128))]))),128))])]))}});var he=F(ye,[["__scopeId","data-v-5cbcabc0"]]);const ve=c=>(D("data-v-5412fa70"),c=c(),M(),c),ge=ve(()=>f("h1",null,"\u30D7\u30EC\u30A4\u753B\u9762",-1)),we={class:"container"},be={class:"tetris"},ke={class:"field",style:{"border-collapse":"collapse"}},Ae={class:"information"},xe={class:"data"},Ce=["onClick"],Pe=I({setup(c){const e={GAMESTART:1,PLAYING:2,GAMEOVER:3};let t=new y;const a=P({gameStatus:e.GAMESTART}),r=()=>a.gameStatus!==e.PLAYING,o=()=>a.gameStatus=e.PLAYING,n=P({field:new y,score:0});Z(a,l=>{switch(l.gameStatus){case e.GAMESTART:break;case e.PLAYING:document.addEventListener("keydown",T),t=new y,n.field=new y,s.current=p.random(),s.next=p.random(),n.score=0,C();break;case e.GAMEOVER:document.removeEventListener("keydown",T),s.next=p.empty();break}});const s=P({current:p.empty(),position:{x:3,y:0},rotate:0,next:p.empty()}),h=()=>p.rotate(s.rotate,s.current.data),N=(l,i)=>{const u=n.field.data[i][l];if(u>0)return p.id(u);const{x:d,y:v}=s.position,A=h();if(v<=i&&i<v+A.length){const B=A[i-v];if(d<=l&&l<d+B.length&&B[l-d]>0)return p.id(B[l-d])}return""},x=()=>{const{x:l,y:i}=s.position,u={x:l,y:i+1},d=h();return n.field.canMove(d,u)},S=()=>{const l=h(),i=s.position;n.field.update(l,i);const{field:u,score:d}=V();t=new y(u),n.field=y.deepCopy(t),n.score+=d,s.current=s.next,s.next=p.random(),s.rotate=0,s.position={x:3,y:0},x()||(a.gameStatus=e.GAMEOVER,C(!0))},T=l=>{switch(l.key){case" ":{const i=(s.rotate+1)%4,u=p.rotate(i,s.current.data);n.field.canMove(u,s.position)&&(s.rotate=i)}break;case"Down":case"ArrwDown":x()?(s.position.y++,C()):S();break;case"Up":case"ArrowUp":for(;x();)s.position.y++,C();S();break;case"Left":case"ArrowLeft":{const i=h(),{x:u,y:d}=s.position,v={x:u-1,y:d};n.field.canMove(i,v)&&s.position.x--}break;case"Right":case"ArrowRight":{const i=h(),{x:u,y:d}=s.position,v={x:u+1,y:d};n.field.canMove(i,v)&&s.position.x++}break}},V=()=>{let l=0;const i=n.field.data.filter(u=>u.every(d=>d>0)?(l++,!1):!0);for(let u=0;u<l;u++)i.unshift(new Array(i[0].length).fill(0));return{score:l,field:i}};H(function(){document.removeEventListener("keydown",T)});const C=(()=>{let l=-1;return(i=!1)=>{l!==-1&&clearInterval(l),!i&&(l=setInterval(()=>{n.field=y.deepCopy(t),x()?s.position.y++:S()},1*1e3))}})();return(l,i)=>(_(),m(k,null,[ge,f("h2",null,"\u30E6\u30FC\u30B6\u540D\uFF1A "+L(l.$route.query.name),1),f("div",we,[f("div",be,[f("table",ke,[(_(!0),m(k,null,E(b(n).field.data,(u,d)=>(_(),m("tr",{key:d},[(_(!0),m(k,null,E(u,(v,A)=>(_(),m("td",{key:()=>`${A}${d}`,class:R(["block",N(A,d)])},null,2))),128))]))),128))])]),f("div",Ae,[W(he,{tetromino:b(s).next.data},null,8,["tetromino"]),f("ul",xe,[f("li",null,"\u30B9\u30B3\u30A2\uFF1A "+L(b(n).score),1),f("li",null,[r()?(_(),m("button",{key:0,onClick:Q(o,["self","stop"])},"\u30B2\u30FC\u30E0\u30B9\u30BF\u30FC\u30C8",8,Ce)):X("",!0)])])])])],64))}});var Ee=F(Pe,[["__scopeId","data-v-5412fa70"]]);const Fe=[{path:"/",name:"TopPage",component:de},{path:"/play",name:"PlayPage",component:Ee}],Se=ee({history:te(),routes:Fe});oe(ae).use(Se).mount("#app");
